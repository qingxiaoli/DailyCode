    for k1 = 1 : size(img, 1)
        for k2 = 1 : size(img, 2)
            v = sqrt(tmp(k1, k2) ^ 2 + tmp(k1 + size(img, 1), k2) ^ 2);
            if v > TAU
                tmp(k1, k2) = tmp(k1, k2) / v * (v - TAU);
                tmp(k1 + size(img, 1), k2) = tmp(k1 + size(img, 1), k2) / v * (v - TAU);
            else
                tmp(k1, k2) = 0;
                tmp(k1 + size(img, 1), k2) = 0;
            end;
        end;
    end;

